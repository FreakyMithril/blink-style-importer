"use strict";var optionsVersion="0.2.0",notifyMessage=function(e){return!1},logToConsoleData=function(e){console.log("Real Stored ugly data: "),console.log(e)},OptionsStorage={install:function(){var e={options:{optionsVersion:optionsVersion,editorFontSize:14,logTab:!0,autoSave:!0,autoSaveDelay:1e3,logToConsole:!1}};chrome.storage.sync.set(e),notifyMessage("Default options successfully installed in the storage!")},saveOne:function(e,s){chrome.storage.sync.get(null,function(t){var o={};o.options=t.options,notifyMessage(o),o.options[e]=s,notifyMessage(o),chrome.storage.sync.remove("options"),chrome.storage.sync.set(o),notifyMessage("All Fine, Saved one item")}),notifyMessage("Option successfully added to the storage!")},saveAll:function(e){chrome.storage.sync.get(null,function(){var s={};s.options=e,s.options.optionsVersion=optionsVersion,notifyMessage(s),chrome.storage.sync.remove("options"),chrome.storage.sync.set(s),notifyMessage("All Fine, saved all new Options")}),notifyMessage("Option successfully updated in the storage!")},clearAll:function(){chrome.storage.sync.remove("options"),notifyMessage("Options cleared!")}},Storage={saveIn:function(e,s){var t={};t[e]=s,chrome.storage.sync.set(t,function(){chrome.runtime.lastError?(console.log(chrome.runtime.lastError.message),notifyMessage("Data NOT been saved in the storage!")):notifyMessage("Data successfully saved to the storage!")})},readCurrent:function(e,s){chrome.storage.sync.get(e,function(t){s(t[e]||!1)}),notifyMessage("Just readed searched data from storage")},readAll:function(){chrome.storage.sync.get(null,function(e){logToConsoleData(e)})},clearCurrent:function(e){chrome.storage.sync.remove(e),notifyMessage("Styles data for current site cleared!")},clearAll:function(){chrome.storage.sync.clear(),notifyMessage("All data in Storage cleared!")}},StyleOnPage={addThem:function(e){notifyMessage("Need check for Exist in HTML before add, and remove if Exist"),StyleOnPage.removeThem();var s=document.createElement("style");return s.type="text/css",s.id="blinkStyles",s.innerHTML=JSON.parse(e),document.getElementsByTagName("body")[0].appendChild(s),notifyMessage("Styles on Page Added"),!0},removeThem:function(){var e=document.getElementById("blinkStyles");return null===e?(notifyMessage("Blink style in HTML Not exist"),!1):(notifyMessage("Blink style Exist"),document.getElementsByTagName("body")[0].removeChild(e),notifyMessage("Styles Removed"),!0)},checkForExist:function(){var e=document.getElementById("blinkStyles");return null===e?(notifyMessage("Blink style in HTML Not exist, cant load"),!1):(notifyMessage("Blink style Exist, try to load"),e.innerHTML)}};chrome.runtime.onMessage.addListener(function(e,s,t){notifyMessage("Something happening from the extension");var o=e.url||{},n=e.styles||{};switch(e.greeting){case"removeAllData":Storage.clearAll(),t({success:!0});break;case"removeCurrentData":StyleOnPage.removeThem()?(Storage.clearCurrent(e.pageUrl),t({success:!0})):t({success:!1});break;case"loadCurrentData":Storage.readCurrent(e.pageUrl,function(s){s?(notifyMessage("There is searched key: '"+e.pageUrl+"' in Storage"),t({currentData:s,success:!0})):(notifyMessage("No key in Storage"),t({success:!1}))});break;case"loadAllData":Storage.readAll(),notifyMessage("Data Loaded"),t({success:!0});break;case"loadDataAndSave":Storage.readCurrent(e.pageUrl,function(s){s?(notifyMessage("There is searched key: '"+e.pageUrl+"' in Storage, try to save to page"),StyleOnPage.addThem(s),t({success:!0})):(notifyMessage("No key in Storage"),t({success:!1}))});break;case"optionsClear":OptionsStorage.clearAll(),t({success:!0});break;case"optionsDefault":OptionsStorage.install(),t({success:!0});break;case"optionsSave":OptionsStorage.saveAll(e.optionsData),t({success:!0});break;default:StyleOnPage.addThem(n)?(Storage.saveIn(o,n),t({currentData:n,success:!0})):t({success:!1})}return!0});